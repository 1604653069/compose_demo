# Jetpack Compose 基础显示组件完全指南

## 前言

在 Jetpack Compose 中，基础显示组件构成了应用的视觉基础。本文将详细介绍 Material 3 中的核心显示组件，包括 Text、Button、TextField 和 FloatingActionButton（FAB），帮助你构建美观且功能丰富的用户界面。

---

## 1. Text 组件 - 文字显示的基础

Text 是 Compose 中最基本的组件，用于显示文本内容。

### 1.1 基础用法

```kotlin
@Composable
fun BasicTextExample() {
    Text("Hello, Compose!")
}
```

### 1.2 样式定制

```kotlin
@Composable
fun StyledTextExample() {
    Column {
        // 使用预设样式
        Text(
            text = "标题文本",
            style = MaterialTheme.typography.headlineMedium,
            fontWeight = FontWeight.Bold
        )

        // 自定义样式
        Text(
            text = "自定义文本",
            fontSize = 20.sp,
            color = MaterialTheme.colorScheme.primary,
            fontStyle = FontStyle.Italic
        )

        // 带样式的富文本
        Text(
            text = buildAnnotatedString {
                withStyle(style = SpanStyle(color = MaterialTheme.colorScheme.primary)) {
                    append("Compose")
                }
                append(" 是 ")
                withStyle(style = SpanStyle(fontWeight = FontWeight.Bold)) {
                    append("现代化")
                }
                append(" 的 UI 工具包")
            }
        )
    }
}
```

### 1.3 文本对齐和溢出处理

```kotlin
@Composable
fun TextAlignmentExample() {
    Card(
        modifier = Modifier
            .fillMaxWidth()
            .height(100.dp)
            .padding(16.dp)
    ) {
        Text(
            text = "这是一段很长的文本内容，用于演示文本溢出时的处理效果。" +
                  "Compose 提供了多种溢出处理方式。",
            modifier = Modifier.padding(16.dp),
            maxLines = 3,
            overflow = TextOverflow.Ellipsis,
            textAlign = TextAlign.Justify
        )
    }
}
```

---

## 2. Button 组件 - 用户交互的核心

Button 是处理用户点击交互的核心组件，Material 3 提供了多种按钮样式。

### 2.1 基础按钮类型

```kotlin
@Composable
fun BasicButtonExample() {
    var clickCount by remember { mutableIntStateOf(0) }

    Column(verticalArrangement = Arrangement.spacedBy(8.dp)) {
        // 主要按钮
        Button(
            onClick = { clickCount++ },
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("主要按钮")
        }

        // 轮廓按钮
        OutlinedButton(
            onClick = { clickCount++ },
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("轮廓按钮")
        }

        // 文本按钮
        TextButton(
            onClick = { clickCount++ },
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("文本按钮")
        }

        // 凸起按钮
        ElevatedButton(
            onClick = { clickCount++ },
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("凸起按钮")
        }

        // 显示点击次数
        Text(
            text = "点击次数: $clickCount",
            modifier = Modifier.align(Alignment.CenterHorizontally)
        )
    }
}
```

### 2.2 带图标的按钮

```kotlin
@Composable
fun IconButtonExample() {
    Row(
        modifier = Modifier.fillMaxWidth(),
        horizontalArrangement = Arrangement.spacedBy(8.dp)
    ) {
        // 带图标和文字的按钮
        Button(onClick = { /* 处理添加操作 */ }) {
            Icon(
                imageVector = Icons.Default.Add,
                contentDescription = "添加",
                modifier = Modifier.size(18.dp)
            )
            Spacer(modifier = Modifier.width(4.dp))
            Text("添加")
        }

        // 仅图标的按钮
        IconButton(onClick = { /* 处理喜欢操作 */ }) {
            Icon(
                imageVector = Icons.Default.Favorite,
                contentDescription = "喜欢",
                tint = MaterialTheme.colorScheme.error
            )
        }
    }
}
```

### 2.3 按钮状态和颜色定制

```kotlin
@Composable
fun CustomButtonExample() {
    var isToggleOn by remember { mutableStateOf(false) }

    Column(verticalArrangement = Arrangement.spacedBy(8.dp)) {
        // 不同颜色的按钮
        Row(
            modifier = Modifier.fillMaxWidth(),
            horizontalArrangement = Arrangement.spacedBy(8.dp)
        ) {
            Button(
                onClick = { },
                colors = ButtonDefaults.buttonColors(
                    containerColor = MaterialTheme.colorScheme.secondary
                ),
                modifier = Modifier.weight(1f)
            ) {
                Text("次要按钮")
            }

            Button(
                onClick = { },
                colors = ButtonDefaults.buttonColors(
                    containerColor = MaterialTheme.colorScheme.error
                ),
                modifier = Modifier.weight(1f)
            ) {
                Text("危险按钮")
            }
        }

        // 切换按钮状态
        Button(
            onClick = { isToggleOn = !isToggleOn },
            enabled = true,
            colors = ButtonDefaults.buttonColors(
                containerColor = if (isToggleOn) MaterialTheme.colorScheme.primary
                                else MaterialTheme.colorScheme.surfaceVariant,
                contentColor = if (isToggleOn) MaterialTheme.colorScheme.onPrimary
                               else MaterialTheme.colorScheme.onSurfaceVariant
            )
        ) {
            Text(if (isToggleOn) "已开启" else "已关闭")
        }

        // 禁用状态按钮
        Button(
            onClick = { },
            enabled = false,
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("禁用按钮")
        }
    }
}
```

### 2.4 分割按钮

```kotlin
@Composable
fun SplitButtonExample() {
    Row {
        Button(
            onClick = { /* 主要操作 */ },
            shape = MaterialTheme.shapes.small.copy(
                topEnd = ZeroCornerSize,
                bottomEnd = ZeroCornerSize
            ),
            modifier = Modifier.weight(1f)
        ) {
            Text("保存")
        }

        Button(
            onClick = { /* 显示选项 */ },
            shape = MaterialTheme.shapes.small.copy(
                topStart = ZeroCornerSize,
                bottomStart = ZeroCornerSize
            )
        ) {
            Icon(
                imageVector = Icons.Default.ArrowDropDown,
                contentDescription = "更多选项"
            )
        }
    }
}
```

---

## 3. TextField 组件 - 文本输入的核心

TextField 是用户输入文本的主要组件，提供了丰富的输入和验证功能。

### 3.1 基础文本输入

```kotlin
@Composable
fun BasicTextFieldExample() {
    var text by remember { mutableStateOf("") }

    Column(verticalArrangement = Arrangement.spacedBy(16.dp)) {
        OutlinedTextField(
            value = text,
            onValueChange = { text = it },
            label = { Text("输入内容") },
            placeholder = { Text("请输入文本...") },
            modifier = Modifier.fillMaxWidth()
        )

        // 显示输入内容
        if (text.isNotEmpty()) {
            Text(
                text = "您输入的内容: $text",
                style = MaterialTheme.typography.bodyMedium,
                color = MaterialTheme.colorScheme.primary
            )
        }
    }
}
```

### 3.2 密码输入框

```kotlin
@Composable
fun PasswordFieldExample() {
    var password by remember { mutableStateOf("") }
    var passwordVisible by remember { mutableStateOf(false) }

    OutlinedTextField(
        value = password,
        onValueChange = { password = it },
        label = { Text("密码") },
        placeholder = { Text("请输入密码") },
        visualTransformation = if (passwordVisible) VisualTransformation.None
                              else PasswordVisualTransformation(),
        trailingIcon = {
            IconButton(onClick = { passwordVisible = !passwordVisible }) {
                Icon(
                    imageVector = if (passwordVisible) Icons.Default.Visibility
                                  else Icons.Default.VisibilityOff,
                    contentDescription = if (passwordVisible) "隐藏密码" else "显示密码"
                )
            }
        },
        modifier = Modifier.fillMaxWidth()
    )
}
```

### 3.3 带验证的输入框

```kotlin
@Composable
fun ValidatedTextFieldExample() {
    var email by remember { mutableStateOf("") }
    var isError by remember { mutableStateOf(false) }

    val emailPattern = Regex("[a-zA-Z0-9._-]+@[a-z]+\\.+[a-z]+")

    OutlinedTextField(
        value = email,
        onValueChange = {
            email = it
            isError = !emailPattern.matches(email) && email.isNotEmpty()
        },
        label = { Text("邮箱地址") },
        isError = isError,
        supportingText = {
            if (isError) {
                Text(
                    text = "请输入有效的邮箱地址",
                    color = MaterialTheme.colorScheme.error
                )
            }
        },
        leadingIcon = {
            Icon(
                imageVector = Icons.Default.Email,
                contentDescription = "邮箱"
            )
        },
        modifier = Modifier.fillMaxWidth()
    )
}
```

### 3.4 多种输入类型

```kotlin
@Composable
fun VariousInputTypesExample() {
    var number by remember { mutableStateOf("") }
    var phone by remember { mutableStateOf("") }
    var description by remember { mutableStateOf("") }

    Column(verticalArrangement = Arrangement.spacedBy(16.dp)) {
        // 数字输入
        OutlinedTextField(
            value = number,
            onValueChange = { if (it.all { char -> char.isDigit() }) number = it },
            label = { Text("年龄") },
            keyboardOptions = KeyboardOptions(keyboardType = KeyboardType.Number),
            modifier = Modifier.fillMaxWidth()
        )

        // 电话号码输入
        OutlinedTextField(
            value = phone,
            onValueChange = { phone = it },
            label = { Text("电话号码") },
            keyboardOptions = KeyboardOptions(
                keyboardType = KeyboardType.Phone,
                imeAction = ImeAction.Next
            ),
            leadingIcon = {
                Icon(
                    imageVector = Icons.Default.Phone,
                    contentDescription = "电话"
                )
            },
            modifier = Modifier.fillMaxWidth()
        )

        // 多行文本输入
        OutlinedTextField(
            value = description,
            onValueChange = { description = it },
            label = { Text("描述") },
            placeholder = { Text("请输入详细描述...") },
            minLines = 3,
            maxLines = 5,
            modifier = Modifier.fillMaxWidth()
        )
    }
}
```

---

## 4. FloatingActionButton (FAB) - 浮动操作按钮

FAB 是 Material Design 中的重要组件，用于应用中的主要操作。

### 4.1 基础 FAB

```kotlin
@Composable
fun BasicFabExample() {
    var itemCount by remember { mutableIntStateOf(0) }

    Scaffold(
        floatingActionButton = {
            FloatingActionButton(
                onClick = { itemCount++ }
            ) {
                Icon(
                    imageVector = Icons.Default.Add,
                    contentDescription = "添加项目"
                )
            }
        }
    ) { paddingValues ->
        Column(
            modifier = Modifier
                .padding(paddingValues)
                .padding(16.dp)
                .fillMaxSize()
        ) {
            Text(
                text = "项目数量: $itemCount",
                style = MaterialTheme.typography.headlineMedium
            )

            // 显示项目列表
            repeat(itemCount) { index ->
                Card(
                    modifier = Modifier
                        .fillMaxWidth()
                        .padding(vertical = 4.dp)
                ) {
                    Text(
                        text = "项目 ${index + 1}",
                        modifier = Modifier.padding(16.dp)
                    )
                }
            }
        }
    }
}
```

### 4.2 不同尺寸的 FAB

```kotlin
@Composable
fun FabSizesExample() {
    Row(
        modifier = Modifier.fillMaxWidth(),
        horizontalArrangement = Arrangement.SpaceEvenly
    ) {
        // 小尺寸 FAB
        FloatingActionButton(
            onClick = { /* 小按钮操作 */ },
            modifier = Modifier.size(40.dp)
        ) {
            Icon(
                Icons.Default.Edit,
                contentDescription = "编辑",
                modifier = Modifier.size(20.dp)
            )
        }

        // 默认 FAB
        FloatingActionButton(
            onClick = { /* 默认操作 */ }
        ) {
            Icon(
                Icons.Default.Add,
                contentDescription = "添加"
            )
        }

        // 大尺寸 FAB
        FloatingActionButton(
            onClick = { /* 大按钮操作 */ },
            modifier = Modifier.size(80.dp)
        ) {
            Icon(
                Icons.Default.Camera,
                contentDescription = "相机",
                modifier = Modifier.size(40.dp)
            )
        }
    }
}
```

### 4.3 扩展 FAB

```kotlin
@Composable
fun ExtendedFabExample() {
    ExtendedFloatingActionButton(
        onClick = { /* 扩展操作 */ },
        icon = {
            Icon(
                imageVector = Icons.Default.Mail,
                contentDescription = "邮件"
            )
        },
        text = { Text("撰写邮件") },
        modifier = Modifier.fillMaxWidth()
    )
}
```

---

## 5. 实践示例：完整的登录表单

让我们结合前面学到的组件，创建一个完整的登录表单：

```kotlin
@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun LoginFormExample() {
    var email by remember { mutableStateOf("") }
    var password by remember { mutableStateOf("") }
    var passwordVisible by remember { mutableStateOf(false) }
    var isLoading by remember { mutableStateOf(false) }
    var showError by remember { mutableStateOf(false) }

    val isFormValid = email.isNotBlank() && password.length >= 6

    Card(
        modifier = Modifier
            .fillMaxWidth()
            .padding(16.dp),
        elevation = CardDefaults.cardElevation(defaultElevation = 8.dp)
    ) {
        Column(
            modifier = Modifier.padding(24.dp),
            verticalArrangement = Arrangement.spacedBy(20.dp)
        ) {
            Text(
                text = "用户登录",
                style = MaterialTheme.typography.headlineMedium,
                fontWeight = FontWeight.Bold,
                modifier = Modifier.align(Alignment.CenterHorizontally)
            )

            // 邮箱输入
            OutlinedTextField(
                value = email,
                onValueChange = {
                    email = it
                    showError = false
                },
                label = { Text("邮箱地址") },
                leadingIcon = {
                    Icon(Icons.Default.Email, contentDescription = "邮箱")
                },
                isError = showError && email.isBlank(),
                supportingText = {
                    if (showError && email.isBlank()) {
                        Text(
                            text = "请输入邮箱地址",
                            color = MaterialTheme.colorScheme.error
                        )
                    }
                },
                keyboardOptions = KeyboardOptions(
                    keyboardType = KeyboardType.Email,
                    imeAction = ImeAction.Next
                ),
                modifier = Modifier.fillMaxWidth()
            )

            // 密码输入
            OutlinedTextField(
                value = password,
                onValueChange = {
                    password = it
                    showError = false
                },
                label = { Text("密码") },
                leadingIcon = {
                    Icon(Icons.Default.Lock, contentDescription = "密码")
                },
                trailingIcon = {
                    IconButton(onClick = { passwordVisible = !passwordVisible }) {
                        Icon(
                            imageVector = if (passwordVisible) Icons.Default.Visibility
                                          else Icons.Default.VisibilityOff,
                            contentDescription = if (passwordVisible) "隐藏密码" else "显示密码"
                        )
                    }
                },
                visualTransformation = if (passwordVisible) VisualTransformation.None
                                      else PasswordVisualTransformation(),
                isError = showError && password.length < 6,
                supportingText = {
                    if (showError && password.length < 6) {
                        Text(
                            text = "密码至少需要6位字符",
                            color = MaterialTheme.colorScheme.error
                        )
                    }
                },
                keyboardOptions = KeyboardOptions(
                    keyboardType = KeyboardType.Password,
                    imeAction = ImeAction.Done
                ),
                modifier = Modifier.fillMaxWidth()
            )

            // 记住我
            Row(
                modifier = Modifier.fillMaxWidth(),
                verticalAlignment = Alignment.CenterVertically
            ) {
                Checkbox(
                    checked = false,
                    onCheckedChange = { }
                )
                Spacer(modifier = Modifier.width(8.dp))
                Text("记住我")

                Spacer(modifier = Modifier.weight(1f))

                TextButton(onClick = { /* 忘记密码 */ }) {
                    Text("忘记密码？")
                }
            }

            // 登录按钮
            Button(
                onClick = {
                    if (isFormValid) {
                        isLoading = true
                        // 模拟登录请求
                        // 在实际应用中，这里会调用 ViewModel 或 Repository
                    } else {
                        showError = true
                    }
                },
                enabled = !isLoading && isFormValid,
                modifier = Modifier.fillMaxWidth()
            ) {
                if (isLoading) {
                    CircularProgressIndicator(
                        modifier = Modifier.size(20.dp),
                        color = MaterialTheme.colorScheme.onPrimary,
                        strokeWidth = 2.dp
                    )
                } else {
                    Text("登录")
                }
            }

            // 注册链接
            Row(
                modifier = Modifier.align(Alignment.CenterHorizontally)
            ) {
                Text("还没有账号？")
                TextButton(onClick = { /* 跳转注册 */ }) {
                    Text("立即注册")
                }
            }
        }
    }
}
```

---

## 6. 最佳实践

### 6.1 文本处理最佳实践

1. **使用 Material 3 字体样式**：优先使用 `MaterialTheme.typography` 中的预定义样式
2. **合理处理文本溢出**：为长文本设置 `maxLines` 和 `overflow`
3. **支持国际化**：将文本字符串提取到资源文件中

### 6.2 按钮设计最佳实践

1. **选择合适的按钮类型**：
   - `Button`：主要操作
   - `OutlinedButton`：次要操作
   - `TextButton`：低重要性操作

2. **保持一致性**：在应用中保持按钮样式和使用场景的一致性
3. **提供清晰的反馈**：按钮点击后应立即给出视觉反馈

### 6.3 输入框优化建议

1. **提供清晰的标签和提示**：帮助用户理解输入要求
2. **实时验证**：在用户输入时提供即时反馈
3. **设置合适的键盘类型**：根据输入内容选择合适的键盘
4. **支持无障碍访问**：添加适当的 `contentDescription`

---

## 7. 总结

基础显示组件是 Compose 应用的构建基石。通过掌握 Text、Button、TextField 和 FAB 组件的使用，你可以：

1. **创建清晰的文本展示**：使用合适的样式和格式
2. **处理用户交互**：通过按钮实现各种操作
3. **收集用户输入**：通过文本输入框获取数据
4. **提供便捷操作**：通过 FAB 实现快速访问

在下一篇文章中，我们将探讨布局和容器组件，学习如何组织这些基础组件来构建更复杂的用户界面。

---

## 相关资源

- [Material 3 Design Documentation](https://m3.material.io/)
- [Compose Text Documentation](https://developer.android.com/jetpack/compose/text)
- [Compose Button Documentation](https://developer.android.com/jetpack/compose/button)
- [Compose TextField Documentation](https://developer.android.com/jetpack/compose/textfield)

---

*本文基于 Android Jetpack Compose 最新版本编写，部分 API 可能会随着版本更新而变化。*