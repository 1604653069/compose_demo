# Jetpack Compose 特殊功能组件完全指南

## 前言

在 Jetpack Compose 中，除了基础的 UI 组件外，还有一些特殊功能组件，它们提供了特定的交互方式和用户体验。这些组件包括下拉刷新、滑动删除、进度指示器、状态提示等。本文将详细介绍这些特殊功能组件，帮助你构建更加丰富和交互性更强的用户界面。

---

## 1. PullToRefresh - 下拉刷新

PullToRefresh 是移动应用中常见的交互模式，用户通过下拉列表来触发数据刷新操作。

### 1.1 基础下拉刷新

```kotlin
@Composable
fun BasicPullToRefreshExample() {
    var items by remember { mutableStateOf((1..10).map { "项目 $it" }) }
    var isRefreshing by remember { mutableStateOf(false) }

    LaunchedEffect(isRefreshing) {
        if (isRefreshing) {
            delay(2000) // 模拟网络请求
            items = (1..10).map { "更新项目 $it" }
            isRefreshing = false
        }
    }

    Box(
        modifier = Modifier.fillMaxSize()
    ) {
        LazyColumn(
            modifier = Modifier.fillMaxSize(),
            contentPadding = PaddingValues(16.dp),
            verticalArrangement = Arrangement.spacedBy(8.dp)
        ) {
            items(items) { item ->
                Card(
                    modifier = Modifier.fillMaxWidth()
                ) {
                    Row(
                        modifier = Modifier.padding(16.dp),
                        verticalAlignment = Alignment.CenterVertically
                    ) {
                        Surface(
                            modifier = Modifier.size(48.dp),
                            shape = CircleShape,
                            color = MaterialTheme.colorScheme.primaryContainer
                        ) {
                            Box(contentAlignment = Alignment.Center) {
                                Icon(
                                    Icons.Default.Refresh,
                                    contentDescription = null,
                                    tint = MaterialTheme.colorScheme.primary
                                )
                            }
                        }
                        Spacer(modifier = Modifier.width(12.dp))
                        Column(modifier = Modifier.weight(1f)) {
                            Text(
                                text = item,
                                style = MaterialTheme.typography.titleMedium
                            )
                            Text(
                                text = "最后更新: ${System.currentTimeMillis()}",
                                style = MaterialTheme.typography.bodySmall,
                                color = MaterialTheme.colorScheme.onSurfaceVariant
                            )
                        }
                    }
                }
            }
        }

        if (isRefreshing) {
            Box(
                modifier = Modifier
                    .fillMaxWidth()
                    .padding(16.dp),
                contentAlignment = Alignment.TopCenter
            ) {
                CircularProgressIndicator(
                    modifier = Modifier.size(24.dp),
                    strokeWidth = 2.dp
                )
            }
        }
    }
}
```

### 1.2 自定义下拉刷新指示器

```kotlin
@Composable
fun CustomPullToRefreshExample() {
    var isRefreshing by remember { mutableStateOf(false) }
    val pullToRefreshState = rememberPullToRefreshState()

    LaunchedEffect(isRefreshing) {
        if (isRefreshing) {
            delay(2000)
            isRefreshing = false
        }
    }

    Box(
        modifier = Modifier
            .fillMaxSize()
            .pullToRefresh(
                state = pullToRefreshState,
                isRefreshing = isRefreshing,
                onRefresh = {
                    isRefreshing = true
                },
                threshold = 80.dp,
                enabled = true
            )
    ) {
        LazyColumn(
            modifier = Modifier.fillMaxSize(),
            contentPadding = PaddingValues(16.dp),
            verticalArrangement = Arrangement.spacedBy(8.dp)
        ) {
            item {
                Text(
                    text = "下拉刷新列表",
                    style = MaterialTheme.typography.headlineMedium,
                    fontWeight = FontWeight.Bold,
                    modifier = Modifier.padding(bottom = 16.dp)
                )
            }

            items(15) { index ->
                Card(
                    modifier = Modifier.fillMaxWidth()
                ) {
                    Row(
                        modifier = Modifier.padding(16.dp),
                        verticalAlignment = Alignment.CenterVertically
                    ) {
                        Surface(
                            modifier = Modifier.size(48.dp),
                            shape = CircleShape,
                            color = MaterialTheme.colorScheme.secondaryContainer
                        ) {
                            Box(contentAlignment = Alignment.Center) {
                                Text(
                                    text = "${index + 1}",
                                    style = MaterialTheme.typography.titleMedium,
                                    color = MaterialTheme.colorScheme.onSecondaryContainer
                                )
                            }
                        }
                        Spacer(modifier = Modifier.width(12.dp))
                        Column(modifier = Modifier.weight(1f)) {
                            Text(
                                text = "自定义刷新项目 ${index + 1}",
                                style = MaterialTheme.typography.titleMedium
                            )
                            Text(
                                text = "支持自定义刷新指示器和动画效果",
                                style = MaterialTheme.typography.bodySmall,
                                color = MaterialTheme.colorScheme.onSurfaceVariant
                            )
                        }
                    }
                }
            }
        }

        // 自定义刷新指示器
        if (pullToRefreshState.isRefreshing) {
            Box(
                modifier = Modifier
                    .fillMaxWidth()
                    .padding(16.dp),
                contentAlignment = Alignment.TopCenter
            ) {
                Row(
                    verticalAlignment = Alignment.CenterVertically,
                    horizontalArrangement = Arrangement.Center
                ) {
                    CircularProgressIndicator(
                        modifier = Modifier.size(20.dp),
                        strokeWidth = 2.dp,
                        color = MaterialTheme.colorScheme.primary
                    )
                    Spacer(modifier = Modifier.width(8.dp))
                    Text(
                        text = "正在刷新...",
                        style = MaterialTheme.typography.bodySmall,
                        color = MaterialTheme.colorScheme.primary
                    )
                }
            }
        }
    }
}
```

---

## 2. SwipeToDismiss - 滑动删除

SwipeToDismiss 允许用户通过滑动列表项来执行删除或其他操作。

### 2.1 基础滑动删除

```kotlin
@Composable
fun BasicSwipeToDismissExample() {
    var items by remember { mutableStateOf((1..10).map { "可滑动删除的项目 $it" }) }

    LazyColumn(
        modifier = Modifier.fillMaxSize(),
        contentPadding = PaddingValues(16.dp),
        verticalArrangement = Arrangement.spacedBy(8.dp)
    ) {
        items(items, key = { it }) { item ->
            var dismissed by remember { mutableStateOf(false) }
            val dismissState = rememberDismissState(
                confirmValueChange = {
                    if (it != DismissValue.Default) {
                        dismissed = true
                        true
                    } else {
                        false
                    }
                }
            )

            if (dismissed) {
                LaunchedEffect(Unit) {
                    delay(300)
                    items = items.filter { it != item }
                }
            }

            SwipeToDismiss(
                state = dismissState,
                background = {
                    val direction = dismissState.dismissDirection
                    val color = when (direction) {
                        DismissDirection.StartToEnd -> MaterialTheme.colorScheme.error
                        DismissDirection.EndToStart -> MaterialTheme.colorScheme.error
                        else -> Color.Transparent
                    }

                    Box(
                        modifier = Modifier
                            .fillMaxSize()
                            .background(color)
                            .padding(16.dp),
                        contentAlignment = when (direction) {
                            DismissDirection.StartToEnd -> Alignment.CenterStart
                            DismissDirection.EndToStart -> Alignment.CenterEnd
                            else -> Alignment.Center
                        }
                    ) {
                        Icon(
                            imageVector = Icons.Default.Delete,
                            contentDescription = "删除",
                            tint = Color.White
                        )
                    }
                },
                dismissContent = {
                    Card(
                        modifier = Modifier
                            .fillMaxWidth()
                            .animateItemPlacement()
                    ) {
                        Row(
                            modifier = Modifier.padding(16.dp),
                            verticalAlignment = Alignment.CenterVertically
                        ) {
                            Surface(
                                modifier = Modifier.size(48.dp),
                                shape = CircleShape,
                                color = MaterialTheme.colorScheme.primaryContainer
                            ) {
                                Box(contentAlignment = Alignment.Center) {
                                    Text(
                                        text = item.takeLast(1),
                                        style = MaterialTheme.typography.titleMedium,
                                        color = MaterialTheme.colorScheme.onPrimaryContainer
                                    )
                                }
                            }
                            Spacer(modifier = Modifier.width(12.dp))
                            Column(modifier = Modifier.weight(1f)) {
                                Text(
                                    text = item,
                                    style = MaterialTheme.typography.titleMedium
                                )
                                Text(
                                    text = "向左或向右滑动删除",
                                    style = MaterialTheme.typography.bodySmall,
                                    color = MaterialTheme.colorScheme.onSurfaceVariant
                                )
                            }
                            Icon(
                                imageVector = Icons.Default.Swipe,
                                contentDescription = "滑动提示",
                                tint = MaterialTheme.colorScheme.onSurfaceVariant
                            )
                        }
                    }
                },
                directions = setOf(DismissDirection.EndToStart)
            )
        }
    }
}
```

### 2.2 多方向滑动操作

```kotlin
@Composable
fun MultiDirectionSwipeExample() {
    var items by remember { mutableStateOf((1..8).map { "多方向操作项目 $it" }) }

    LazyColumn(
        modifier = Modifier.fillMaxSize(),
        contentPadding = PaddingValues(16.dp),
        verticalArrangement = Arrangement.spacedBy(8.dp)
    ) {
        items(items, key = { it }) { item ->
            var dismissed by remember { mutableStateOf(false) }
            var action by remember { mutableStateOf<String?>(null) }

            val dismissState = rememberDismissState(
                confirmValueChange = {
                    when (it) {
                        DismissDirection.StartToEnd -> {
                            action = "收藏"
                            dismissed = true
                            true
                        }
                        DismissDirection.EndToStart -> {
                            action = "删除"
                            dismissed = true
                            true
                        }
                        else -> false
                    }
                }
            )

            if (dismissed) {
                LaunchedEffect(Unit) {
                    delay(300)
                    Toast.makeText(LocalContext.current, "已$action: $item", Toast.LENGTH_SHORT).show()
                    items = items.filter { it != item }
                }
            }

            SwipeToDismiss(
                state = dismissState,
                background = {
                    val direction = dismissState.dismissDirection
                    when (direction) {
                        DismissDirection.StartToEnd -> {
                            Box(
                                modifier = Modifier
                                    .fillMaxSize()
                                    .background(MaterialTheme.colorScheme.primary)
                                    .padding(16.dp),
                                contentAlignment = Alignment.CenterStart
                            ) {
                                Row(
                                    verticalAlignment = Alignment.CenterVertically
                                ) {
                                    Icon(
                                        imageVector = Icons.Default.Favorite,
                                        contentDescription = "收藏",
                                        tint = Color.White
                                    )
                                    Spacer(modifier = Modifier.width(8.dp))
                                    Text(
                                        text = "收藏",
                                        color = Color.White,
                                        style = MaterialTheme.typography.bodyMedium
                                    )
                                }
                            }
                        }
                        DismissDirection.EndToStart -> {
                            Box(
                                modifier = Modifier
                                    .fillMaxSize()
                                    .background(MaterialTheme.colorScheme.error)
                                    .padding(16.dp),
                                contentAlignment = Alignment.CenterEnd
                            ) {
                                Row(
                                    verticalAlignment = Alignment.CenterVertically
                                ) {
                                    Text(
                                        text = "删除",
                                        color = Color.White,
                                        style = MaterialTheme.typography.bodyMedium
                                    )
                                    Spacer(modifier = Modifier.width(8.dp))
                                    Icon(
                                        imageVector = Icons.Default.Delete,
                                        contentDescription = "删除",
                                        tint = Color.White
                                    )
                                }
                            }
                        }
                        else -> {}
                    }
                },
                dismissContent = {
                    Card(
                        modifier = Modifier
                            .fillMaxWidth()
                            .animateItemPlacement()
                    ) {
                        Row(
                            modifier = Modifier.padding(16.dp),
                            verticalAlignment = Alignment.CenterVertically
                        ) {
                            Surface(
                                modifier = Modifier.size(48.dp),
                                shape = CircleShape,
                                color = MaterialTheme.colorScheme.secondaryContainer
                            ) {
                                Box(contentAlignment = Alignment.Center) {
                                    Text(
                                        text = item.takeLast(1),
                                        style = MaterialTheme.typography.titleMedium,
                                        color = MaterialTheme.colorScheme.onSecondaryContainer
                                    )
                                }
                            }
                            Spacer(modifier = Modifier.width(12.dp))
                            Column(modifier = Modifier.weight(1f)) {
                                Text(
                                    text = item,
                                    style = MaterialTheme.typography.titleMedium
                                )
                                Text(
                                    text = "→ 收藏 | 删除 ←",
                                    style = MaterialTheme.typography.bodySmall,
                                    color = MaterialTheme.colorScheme.onSurfaceVariant
                                )
                            }
                        }
                    }
                },
                directions = setOf(DismissDirection.StartToEnd, DismissDirection.EndToStart)
            )
        }
    }
}
```

---

## 3. Snackbar - 临时消息提示

Snackbar 用于显示临时的操作反馈或状态信息，会自动消失或由用户手动关闭。

### 3.1 基础 Snackbar

```kotlin
@Composable
fun BasicSnackbarExample() {
    val snackbarHostState = remember { SnackbarHostState() }
    var messageCount by remember { mutableIntStateOf(0) }

    Column(
        modifier = Modifier
            .fillMaxSize()
            .padding(16.dp)
    ) {
        Text(
            text = "Snackbar 示例",
            style = MaterialTheme.typography.headlineMedium,
            fontWeight = FontWeight.Bold,
            modifier = Modifier.padding(bottom = 16.dp)
        )

        Row(
            modifier = Modifier.fillMaxWidth(),
            horizontalArrangement = Arrangement.spacedBy(8.dp)
        ) {
            Button(
                onClick = {
                    messageCount++
                },
                modifier = Modifier.weight(1f)
            ) {
                Text("简单消息")
            }

            Button(
                onClick = {
                    messageCount++
                },
                modifier = Modifier.weight(1f)
            ) {
                Text("带操作消息")
            }

            Button(
                onClick = {
                    messageCount++
                },
                modifier = Modifier.weight(1f)
            ) {
                Text("自定义消息")
            }
        }

        Spacer(modifier = Modifier.height(16.dp))

        Text(
            text = "已显示消息数: $messageCount",
            style = MaterialTheme.typography.bodyMedium,
            color = MaterialTheme.colorScheme.primary
        )

        // Snackbar 显示按钮
        Column(
            verticalArrangement = Arrangement.spacedBy(12.dp)
        ) {
            Card {
                Column(
                    modifier = Modifier.padding(16.dp),
                    verticalArrangement = Arrangement.spacedBy(8.dp)
                ) {
                    Text(
                        text = "简单消息",
                        style = MaterialTheme.typography.titleSmall,
                        fontWeight = FontWeight.Bold
                    )
                    Text(
                        text = "显示基本的文本消息，自动消失",
                        style = MaterialTheme.typography.bodySmall
                    )
                    Button(
                        onClick = {
                            CoroutineScope(Dispatchers.Main).launch {
                                snackbarHostState.showSnackbar(
                                    message = "这是一个简单的 Snackbar 消息",
                                    duration = SnackbarDuration.Short
                                )
                            }
                        },
                        modifier = Modifier.fillMaxWidth()
                    ) {
                        Text("显示简单消息")
                    }
                }
            }

            Card {
                Column(
                    modifier = Modifier.padding(16.dp),
                    verticalArrangement = Arrangement.spacedBy(8.dp)
                ) {
                    Text(
                        text = "带操作的消息",
                        style = MaterialTheme.typography.titleSmall,
                        fontWeight = FontWeight.Bold
                    )
                    Text(
                        text = "包含操作按钮，用户可以点击执行",
                        style = MaterialTheme.typography.bodySmall
                    )
                    Button(
                        onClick = {
                            CoroutineScope(Dispatchers.Main).launch {
                                val result = snackbarHostState.showSnackbar(
                                    message = "是否执行此操作？",
                                    actionLabel = "执行",
                                    duration = SnackbarDuration.Long
                                )
                                if (result == SnackbarResult.ActionPerformed) {
                                    // 用户点击了操作
                                }
                            }
                        },
                        modifier = Modifier.fillMaxWidth()
                    ) {
                        Text("显示带操作消息")
                    }
                }
            }
        }

        Spacer(modifier = Modifier.weight(1f))

        // Snackbar 宿主
        SnackbarHost(
            hostState = snackbarHostState,
            modifier = Modifier.align(Alignment.CenterHorizontally)
        ) { data ->
            Snackbar(
                snackbarData = data,
                modifier = Modifier.padding(8.dp)
            )
        }
    }
}
```

### 2.2 自定义 Snackbar

```kotlin
@Composable
fun CustomSnackbarExample() {
    val snackbarHostState = remember { SnackbarHostState() }
    var snackType by remember { mutableStateOf("success") }

    Scaffold(
        snackbarHost = {
            SnackbarHost(hostState = snackbarHostState) { data ->
                val containerColor = when (snackType) {
                    "success" -> MaterialTheme.colorScheme.primary
                    "error" -> MaterialTheme.colorScheme.error
                    "warning" -> MaterialTheme.colorScheme.secondary
                    else -> MaterialTheme.colorScheme.surface
                }

                val icon = when (snackType) {
                    "success" -> Icons.Default.CheckCircle
                    "error" -> Icons.Default.Error
                    "warning" -> Icons.Default.Warning
                    else -> Icons.Default.Info
                }

                Card(
                    modifier = Modifier
                        .padding(8.dp)
                        .fillMaxWidth(),
                    elevation = CardDefaults.cardElevation(defaultElevation = 4.dp)
                ) {
                    Row(
                        modifier = Modifier
                            .fillMaxWidth()
                            .padding(16.dp),
                        verticalAlignment = Alignment.CenterVertically
                    ) {
                        Surface(
                            modifier = Modifier.size(24.dp),
                            shape = CircleShape,
                            color = MaterialTheme.colorScheme.onPrimary.copy(alpha = 0.1f)
                        ) {
                            Box(contentAlignment = Alignment.Center) {
                                Icon(
                                    imageVector = icon,
                                    contentDescription = null,
                                    modifier = Modifier.size(16.dp),
                                    tint = MaterialTheme.colorScheme.onPrimary
                                )
                            }
                        }

                        Spacer(modifier = Modifier.width(12.dp))

                        Column(modifier = Modifier.weight(1f)) {
                            Text(
                                text = data.message,
                                style = MaterialTheme.typography.bodyMedium,
                                color = MaterialTheme.colorScheme.onSurface
                            )
                        }

                        data.actionLabel?.let { action ->
                            TextButton(onClick = { data.dismiss() }) {
                                Text(
                                    text = action,
                                    color = MaterialTheme.colorScheme.primary
                                )
                            }
                        }
                    }
                }
            }
        }
    ) { paddingValues ->
        Column(
            modifier = Modifier
                .fillMaxSize()
                .padding(paddingValues)
                .padding(16.dp),
            verticalArrangement = Arrangement.spacedBy(16.dp)
        ) {
            Text(
                text = "自定义 Snackbar",
                style = MaterialTheme.typography.headlineMedium,
                fontWeight = FontWeight.Bold
            )

            // 类型选择
            Card {
                Column(
                    modifier = Modifier.padding(16.dp),
                    verticalArrangement = Arrangement.spacedBy(8.dp)
                ) {
                    Text(
                        text = "选择 Snackbar 类型",
                        style = MaterialTheme.typography.titleMedium,
                        fontWeight = FontWeight.Bold
                    )

                    val types = listOf(
                        "success" to "成功",
                        "error" to "错误",
                        "warning" to "警告",
                        "info" to "信息"
                    )

                    types.forEach { (type, label) ->
                        Row(
                            modifier = Modifier.fillMaxWidth(),
                            verticalAlignment = Alignment.CenterVertically
                        ) {
                            RadioButton(
                                selected = snackType == type,
                                onClick = { snackType = type }
                            )
                            Spacer(modifier = Modifier.width(8.dp))
                            Text(text = label)
                        }
                    }
                }
            }

            // 显示按钮
            Row(
                modifier = Modifier.fillMaxWidth(),
                horizontalArrangement = Arrangement.spacedBy(8.dp)
            ) {
                Button(
                    onClick = {
                        CoroutineScope(Dispatchers.Main).launch {
                            snackbarHostState.showSnackbar(
                                message = "操作成功完成！",
                                actionLabel = "查看",
                                duration = SnackbarDuration.Short
                            )
                        }
                    },
                    modifier = Modifier.weight(1f)
                ) {
                    Text("显示成功消息")
                }

                OutlinedButton(
                    onClick = {
                        CoroutineScope(Dispatchers.Main).launch {
                            snackbarHostState.showSnackbar(
                                message = "发生错误，请稍后重试",
                                duration = SnackbarDuration.Long
                            )
                        }
                    },
                    modifier = Modifier.weight(1f)
                ) {
                    Text("显示错误消息")
                }
            }

            Spacer(modifier = Modifier.weight(1f))
        }
    }
}
```

---

## 4. LoadingIndicator - 加载指示器

加载指示器用于向用户显示正在进行的操作或数据加载状态。

### 4.1 不同类型的加载指示器

```kotlin
@Composable
fun LoadingIndicatorExample() {
    var isLoading by remember { mutableStateOf(false) }
    var loadingType by remember { mutableStateOf("linear") }

    LaunchedEffect(isLoading) {
        if (isLoading) {
            delay(3000)
            isLoading = false
        }
    }

    Column(
        modifier = Modifier
            .fillMaxSize()
            .padding(16.dp),
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        Text(
            text = "加载指示器示例",
            style = MaterialTheme.typography.headlineMedium,
            fontWeight = FontWeight.Bold
        )

        // 类型选择
        Card {
            Column(
                modifier = Modifier.padding(16.dp),
                verticalArrangement = Arrangement.spacedBy(8.dp)
            ) {
                Text(
                    text = "选择加载类型",
                    style = MaterialTheme.typography.titleSmall,
                    fontWeight = FontWeight.Bold
                )

                val types = listOf(
                    "linear" to "线性进度",
                    "circular" to "圆形进度",
                    "dots" to "点状加载",
                    "skeleton" to "骨架屏"
                )

                types.forEach { (type, label) ->
                    Row(
                        modifier = Modifier.fillMaxWidth(),
                        verticalAlignment = Alignment.CenterVertically
                    ) {
                        RadioButton(
                            selected = loadingType == type,
                            onClick = { loadingType = type }
                        )
                        Spacer(modifier = Modifier.width(8.dp))
                        Text(text = label)
                    }
                }
            }
        }

        // 加载按钮
        Button(
            onClick = { isLoading = true },
            enabled = !isLoading,
            modifier = Modifier.fillMaxWidth()
        ) {
            if (isLoading) {
                CircularProgressIndicator(
                    modifier = Modifier.size(16.dp),
                    strokeWidth = 2.dp
                )
                Spacer(modifier = Modifier.width(8.dp))
            }
            Text(if (isLoading) "加载中..." else "开始加载")
        }

        // 加载指示器展示
        Card(
            modifier = Modifier.fillMaxWidth()
        ) {
            Column(
                modifier = Modifier.padding(16.dp),
                verticalArrangement = Arrangement.spacedBy(16.dp)
            ) {
                when (loadingType) {
                    "linear" -> {
                        Column {
                            Text(
                                text = "线性进度条",
                                style = MaterialTheme.typography.titleMedium,
                                fontWeight = FontWeight.Bold
                            )
                            LinearProgressIndicator(
                                modifier = Modifier.fillMaxWidth()
                            )
                            Spacer(modifier = Modifier.height(8.dp))
                            Text(
                                text = "正在加载数据...",
                                style = MaterialTheme.typography.bodySmall,
                                color = MaterialTheme.colorScheme.onSurfaceVariant
                            )
                        }
                    }

                    "circular" -> {
                        Column(
                            horizontalAlignment = Alignment.CenterHorizontally
                        ) {
                            Text(
                                text = "圆形进度条",
                                style = MaterialTheme.typography.titleMedium,
                                fontWeight = FontWeight.Bold
                            )
                            Spacer(modifier = Modifier.height(16.dp))
                            CircularProgressIndicator()
                            Spacer(modifier = Modifier.height(8.dp))
                            Text(
                                text = "正在处理...",
                                style = MaterialTheme.typography.bodySmall,
                                color = MaterialTheme.colorScheme.onSurfaceVariant
                            )
                        }
                    }

                    "dots" -> {
                        Column(
                            horizontalAlignment = Alignment.CenterHorizontally
                        ) {
                            Text(
                                text = "点状加载",
                                style = MaterialTheme.typography.titleMedium,
                                fontWeight = FontWeight.Bold
                            )
                            Spacer(modifier = Modifier.height(16.dp))
                            DotsLoadingIndicator()
                            Spacer(modifier = Modifier.height(8.dp))
                            Text(
                                text = "正在连接服务器...",
                                style = MaterialTheme.typography.bodySmall,
                                color = MaterialTheme.colorScheme.onSurfaceVariant
                            )
                        }
                    }

                    "skeleton" -> {
                        Column {
                            Text(
                                text = "骨架屏加载",
                                style = MaterialTheme.typography.titleMedium,
                                fontWeight = FontWeight.Bold
                            )
                            Spacer(modifier = Modifier.height(16.dp))
                            repeat(3) { index ->
                                SkeletonCard(index = index)
                            }
                        }
                    }
                }
            }
        }
    }
}

@Composable
private fun DotsLoadingIndicator() {
    val infiniteTransition = rememberInfiniteTransition(label = "dots")
    val alpha by infiniteTransition.animateFloat(
        initialValue = 0f,
        targetValue = 1f,
        animationSpec = infiniteRepeatable(
            animation = keyframes {
                durationMillis = 600
                0f at 0
                1f at 300
                0f at 600
            }
        ),
        label = "alpha"
    )

    Row(
        horizontalArrangement = Arrangement.spacedBy(4.dp),
        verticalAlignment = Alignment.CenterVertically
    ) {
        repeat(3) { index ->
            Surface(
                modifier = Modifier.size(8.dp),
                shape = CircleShape,
                color = MaterialTheme.colorScheme.primary.copy(alpha = alpha)
            ) {}
        }
    }
}

@Composable
private fun SkeletonCard(index: Int) {
    Card(
        modifier = Modifier
            .fillMaxWidth()
            .padding(vertical = 4.dp)
    ) {
        Row(
            modifier = Modifier.padding(16.dp),
            verticalAlignment = Alignment.CenterVertically
        ) {
            Surface(
                modifier = Modifier.size(48.dp),
                shape = CircleShape,
                color = MaterialTheme.colorScheme.surfaceVariant
            ) {}

            Spacer(modifier = Modifier.width(12.dp))

            Column(modifier = Modifier.weight(1f)) {
                Surface(
                    modifier = Modifier
                        .fillMaxWidth()
                        .height(16.dp),
                    color = MaterialTheme.colorScheme.surfaceVariant
                ) {}

                Spacer(modifier = Modifier.height(8.dp))

                Surface(
                    modifier = Modifier
                        .fillMaxWidth(0.7f)
                        .height(12.dp),
                    color = MaterialTheme.colorScheme.surfaceVariant
                ) {}
            }
        }
    }
}
```

---

## 5. 实践示例：完整的交互式应用

```kotlin
@Composable
fun InteractiveAppExample() {
    val snackbarHostState = remember { SnackbarHostState() }
    var items by remember { mutableStateOf((1..10).map { "交互项目 $it" }) }
    var isRefreshing by remember { mutableStateOf(false) }

    LaunchedEffect(isRefreshing) {
        if (isRefreshing) {
            delay(2000)
            items = (1..15).map { "刷新项目 $it" }
            isRefreshing = false
        }
    }

    Box(modifier = Modifier.fillMaxSize()) {
        LazyColumn(
            modifier = Modifier.fillMaxSize(),
            contentPadding = PaddingValues(16.dp),
            verticalArrangement = Arrangement.spacedBy(8.dp)
        ) {
            item {
                Text(
                    text = "交互式应用示例",
                    style = MaterialTheme.typography.headlineMedium,
                    fontWeight = FontWeight.Bold,
                    modifier = Modifier.padding(bottom = 16.dp)
                )
            }

            items(items, key = { it }) { item ->
                var dismissed by remember { mutableStateOf(false) }
                val dismissState = rememberDismissState(
                    confirmValueChange = {
                        if (it != DismissValue.Default) {
                            dismissed = true
                            true
                        } else {
                            false
                        }
                    }
                )

                if (dismissed) {
                    LaunchedEffect(Unit) {
                        delay(300)
                        items = items.filter { it != item }
                        CoroutineScope(Dispatchers.Main).launch {
                            snackbarHostState.showSnackbar("已删除: $item")
                        }
                    }
                }

                SwipeToDismiss(
                    state = dismissState,
                    background = {
                        Box(
                            modifier = Modifier
                                .fillMaxSize()
                                .background(MaterialTheme.colorScheme.error)
                                .padding(16.dp),
                            contentAlignment = Alignment.CenterEnd
                        ) {
                            Icon(
                                imageVector = Icons.Default.Delete,
                                contentDescription = "删除",
                                tint = Color.White
                            )
                        }
                    },
                    dismissContent = {
                        Card(
                            modifier = Modifier
                                .fillMaxWidth()
                                .animateItemPlacement()
                        ) {
                            Row(
                                modifier = Modifier.padding(16.dp),
                                verticalAlignment = Alignment.CenterVertically
                            ) {
                                Surface(
                                    modifier = Modifier.size(48.dp),
                                    shape = CircleShape,
                                    color = MaterialTheme.colorScheme.primaryContainer
                                ) {
                                    Box(contentAlignment = Alignment.Center) {
                                        Text(
                                            text = item.takeLast(1),
                                            style = MaterialTheme.typography.titleMedium,
                                            color = MaterialTheme.colorScheme.onPrimaryContainer
                                        )
                                    }
                                }
                                Spacer(modifier = Modifier.width(12.dp))
                                Column(modifier = Modifier.weight(1f)) {
                                    Text(
                                        text = item,
                                        style = MaterialTheme.typography.titleMedium
                                    )
                                    Text(
                                        text = "滑动删除，下拉刷新",
                                        style = MaterialTheme.typography.bodySmall,
                                        color = MaterialTheme.colorScheme.onSurfaceVariant
                                    )
                                }
                                Icon(
                                    imageVector = Icons.Default.Swipe,
                                    contentDescription = "滑动提示",
                                    tint = MaterialTheme.colorScheme.onSurfaceVariant
                                )
                            }
                        }
                    },
                    directions = setOf(DismissDirection.EndToStart)
                )
            }
        }

        // 刷新指示器
        if (isRefreshing) {
            Box(
                modifier = Modifier
                    .fillMaxWidth()
                    .padding(16.dp),
                contentAlignment = Alignment.TopCenter
            ) {
                CircularProgressIndicator()
            }
        }
    }

    // Snackbar
    SnackbarHost(hostState = snackbarHostState)
}
```

---

## 6. 最佳实践

### 6.1 下拉刷新最佳实践

1. **合理的刷新时间**：避免过长的加载时间
2. **清晰的视觉反馈**：明确的加载状态指示
3. **平滑的动画效果**：提供良好的过渡体验
4. **错误处理**：处理刷新失败的情况

### 6.2 滑动删除最佳实践

1. **明确的功能提示**：用户知道滑动的作用
2. **确认机制**：重要操作需要确认
3. **撤销功能**：允许用户撤销误操作
4. **平滑的动画**：自然的滑动和删除效果

### 6.3 Snackbar 最佳实践

1. **简短的消息**：信息简洁明了
2. **适当的持续时间**：给用户足够时间阅读
3. **相关的操作**：提供有用的操作选项
4. **不中断用户流程**：不阻塞用户当前操作

### 6.4 加载指示器最佳实践

1. **选择合适的类型**：根据场景选择合适的指示器
2. **保持一致性**：在应用中使用一致的加载样式
3. **提供上下文**：告诉用户正在加载什么
4. **优雅的错误处理**：加载失败时的处理

---

## 7. 总结

Jetpack Compose 的特殊功能组件提供了丰富的交互体验：

1. **PullToRefresh**：直观的下拉刷新交互
2. **SwipeToDismiss**：便捷的滑动操作
3. **Snackbar**：友好的临时消息提示
4. **LoadingIndicator**：清晰的加载状态显示

通过合理使用这些特殊功能组件，你可以构建交互丰富、用户体验优秀的移动应用。

---

## 相关资源

- [Compose Material Components Documentation](https://developer.android.com/jetpack/compose/components)
- [Material Design Guidelines](https://m3.material.io/)
- [Compose Animation Documentation](https://developer.android.com/jetpack/compose/animation)

---

*本文基于 Android Jetpack Compose 最新版本编写，部分 API 可能会随着版本更新而变化。*