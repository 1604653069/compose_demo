# Jetpack Compose 对话框和弹窗组件完全指南

## 前言

在移动应用中，对话框和弹窗是实现模态交互和临时信息展示的重要组件。它们能够吸引用户注意力，要求用户确认操作或显示重要信息。Jetpack Compose 提供了多种对话框和弹窗组件，包括 AlertDialog、Dialog、ModalBottomSheet 等，支持丰富的自定义选项。本文将详细介绍这些组件的使用方法和最佳实践。

---

## 1. AlertDialog - 标准对话框

AlertDialog 是 Material Design 3 中的标准对话框组件，提供了统一的视觉样式和交互模式。

### 1.1 基础 AlertDialog

```kotlin
@Composable
fun BasicAlertDialogExample() {
    var showDialog by remember { mutableStateOf(false) }
    var dialogResult by remember { mutableStateOf<String?>(null) }

    Column(
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        // 触发按钮
        Button(
            onClick = { showDialog = true },
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("显示基础对话框")
        }

        // 显示结果
        dialogResult?.let { result ->
            Card(
                colors = CardDefaults.cardColors(
                    containerColor = MaterialTheme.colorScheme.primaryContainer
                )
            ) {
                Text(
                    text = "对话框结果: $result",
                    modifier = Modifier.padding(16.dp),
                    color = MaterialTheme.colorScheme.onPrimaryContainer
                )
            }
        }
    }

    // AlertDialog
    if (showDialog) {
        AlertDialog(
            onDismissRequest = {
                showDialog = false
                dialogResult = "对话框已关闭"
            },
            title = {
                Text("基础对话框")
            },
            text = {
                Text("这是一个基础的Material 3对话框示例。对话框用于向用户显示重要信息或要求用户做出决定。")
            },
            confirmButton = {
                TextButton(
                    onClick = {
                        showDialog = false
                        dialogResult = "用户点击了确定"
                    }
                ) {
                    Text("确定")
                }
            },
            dismissButton = {
                TextButton(
                    onClick = {
                        showDialog = false
                        dialogResult = "用户点击了取消"
                    }
                ) {
                    Text("取消")
                }
            }
        )
    }
}
```

### 1.2 带图标的 AlertDialog

```kotlin
@Composable
fun IconAlertDialogExample() {
    var showWarningDialog by remember { mutableStateOf(false) }
    var showSuccessDialog by remember { mutableStateOf(false) }
    var dialogResult by remember { mutableStateOf<String?>(null) }

    Column(
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        Row(
            modifier = Modifier.fillMaxWidth(),
            horizontalArrangement = Arrangement.spacedBy(8.dp)
        ) {
            Button(
                onClick = { showWarningDialog = true },
                colors = ButtonDefaults.buttonColors(
                    containerColor = MaterialTheme.colorScheme.error
                ),
                modifier = Modifier.weight(1f)
            ) {
                Text("警告对话框")
            }

            Button(
                onClick = { showSuccessDialog = true },
                colors = ButtonDefaults.buttonColors(
                    containerColor = MaterialTheme.colorScheme.primary
                ),
                modifier = Modifier.weight(1f)
            ) {
                Text("成功对话框")
            }
        }

        // 显示结果
        dialogResult?.let { result ->
            Card(
                colors = CardDefaults.cardColors(
                    containerColor = MaterialTheme.colorScheme.secondaryContainer
                )
            ) {
                Text(
                    text = "对话框结果: $result",
                    modifier = Modifier.padding(16.dp),
                    color = MaterialTheme.colorScheme.onSecondaryContainer
                )
            }
        }
    }

    // 警告对话框
    if (showWarningDialog) {
        AlertDialog(
            onDismissRequest = {
                showWarningDialog = false
                dialogResult = "警告对话框已关闭"
            },
            icon = {
                Icon(
                    imageVector = Icons.Default.Warning,
                    contentDescription = "警告",
                    tint = MaterialTheme.colorScheme.error
                )
            },
            title = {
                Text("删除确认")
            },
            text = {
                Text("您确定要删除这个项目吗？此操作无法撤销。删除后，所有相关数据将被永久丢失。")
            },
            confirmButton = {
                Button(
                    onClick = {
                        showWarningDialog = false
                        dialogResult = "用户确认删除操作"
                    },
                    colors = ButtonDefaults.buttonColors(
                        containerColor = MaterialTheme.colorScheme.error
                    )
                ) {
                    Text("删除")
                }
            },
            dismissButton = {
                TextButton(
                    onClick = {
                        showWarningDialog = false
                        dialogResult = "用户取消删除操作"
                    }
                ) {
                    Text("取消")
                }
            }
        )
    }

    // 成功对话框
    if (showSuccessDialog) {
        AlertDialog(
            onDismissRequest = {
                showSuccessDialog = false
                dialogResult = "成功对话框已关闭"
            },
            icon = {
                Icon(
                    imageVector = Icons.Default.CheckCircle,
                    contentDescription = "成功",
                    tint = MaterialTheme.colorScheme.primary
                )
            },
            title = {
                Text("操作成功")
            },
            text = {
                Text("恭喜！您的操作已成功完成。系统已保存您的更改，您可以继续进行其他操作。")
            },
            confirmButton = {
                Button(
                    onClick = {
                        showSuccessDialog = false
                        dialogResult = "用户确认成功操作"
                    }
                ) {
                    Text("确定")
                }
            }
        )
    }
}
```

### 1.3 自定义内容 AlertDialog

```kotlin
@Composable
fun CustomContentAlertDialogExample() {
    var showDialog by remember { mutableStateOf(false) }
    var selectedOption by remember { mutableStateOf(0) }
    var dialogResult by remember { mutableStateOf<String?>(null) }

    val options = listOf("选项 1", "选项 2", "选项 3")

    Column(
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        Button(
            onClick = { showDialog = true },
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("显示自定义内容对话框")
        }

        // 显示结果
        dialogResult?.let { result ->
            Card(
                colors = CardDefaults.cardColors(
                    containerColor = MaterialTheme.colorScheme.tertiaryContainer
                )
            ) {
                Text(
                    text = "对话框结果: $result",
                    modifier = Modifier.padding(16.dp),
                    color = MaterialTheme.colorScheme.onTertiaryContainer
                )
            }
        }
    }

    // 自定义内容 AlertDialog
    if (showDialog) {
        AlertDialog(
            onDismissRequest = {
                showDialog = false
                dialogResult = "自定义对话框已关闭"
            },
            title = {
                Text("选择选项")
            },
            text = {
                Column {
                    Text("请选择一个选项：")
                    Spacer(modifier = Modifier.height(16.dp))

                    options.forEachIndexed { index, option ->
                        Row(
                            modifier = Modifier
                                .fillMaxWidth()
                                .clickable { selectedOption = index }
                                .padding(vertical = 8.dp),
                            verticalAlignment = Alignment.CenterVertically
                        ) {
                            RadioButton(
                                selected = selectedOption == index,
                                onClick = { selectedOption = index }
                            )
                            Spacer(modifier = Modifier.width(8.dp))
                            Text(option)
                        }
                    }

                    Spacer(modifier = Modifier.height(16.dp))

                    Text(
                        text = "当前选择: ${options[selectedOption]}",
                        style = MaterialTheme.typography.bodySmall,
                        color = MaterialTheme.colorScheme.primary
                    )
                }
            },
            confirmButton = {
                Button(
                    onClick = {
                        showDialog = false
                        dialogResult = "用户选择了: ${options[selectedOption]}"
                    }
                ) {
                    Text("确认选择")
                }
            },
            dismissButton = {
                TextButton(
                    onClick = {
                        showDialog = false
                        dialogResult = "用户取消了选择"
                    }
                ) {
                    Text("取消")
                }
            }
        )
    }
}
```

---

## 2. Dialog - 通用对话框

Dialog 组件比 AlertDialog 更加灵活，允许你完全自定义对话框的内容和布局。

### 2.1 基础 Dialog

```kotlin
@Composable
fun BasicDialogExample() {
    var showDialog by remember { mutableStateOf(false) }
    var dialogResult by remember { mutableStateOf<String?>(null) }

    Column(
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        Button(
            onClick = { showDialog = true },
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("显示基础 Dialog")
        }

        // 显示结果
        dialogResult?.let { result ->
            Card(
                colors = CardDefaults.cardColors(
                    containerColor = MaterialTheme.colorScheme.primaryContainer
                )
            ) {
                Text(
                    text = "Dialog结果: $result",
                    modifier = Modifier.padding(16.dp),
                    color = MaterialTheme.colorScheme.onPrimaryContainer
                )
            }
        }
    }

    // 基础 Dialog
    if (showDialog) {
        Dialog(
            onDismissRequest = {
                showDialog = false
                dialogResult = "Dialog已关闭"
            }
        ) {
            Card(
                modifier = Modifier
                    .fillMaxWidth()
                    .padding(16.dp),
                elevation = CardDefaults.cardElevation(defaultElevation = 8.dp)
            ) {
                Column(
                    modifier = Modifier.padding(24.dp),
                    horizontalAlignment = Alignment.CenterHorizontally
                ) {
                    Icon(
                        imageVector = Icons.Default.CheckCircle,
                        contentDescription = "成功",
                        tint = MaterialTheme.colorScheme.primary,
                        modifier = Modifier.size(48.dp)
                    )
                    Spacer(modifier = Modifier.height(16.dp))
                    Text(
                        text = "操作成功",
                        style = MaterialTheme.typography.titleMedium
                    )
                    Spacer(modifier = Modifier.height(8.dp))
                    Text(
                        text = "您的操作已成功完成",
                        style = MaterialTheme.typography.bodyMedium,
                        color = MaterialTheme.colorScheme.onSurfaceVariant
                    )
                    Spacer(modifier = Modifier.height(24.dp))
                    Button(
                        onClick = {
                            showDialog = false
                            dialogResult = "用户确认成功"
                        },
                        modifier = Modifier.fillMaxWidth()
                    ) {
                        Text("确定")
                    }
                }
            }
        }
    }
}
```

### 2.2 带输入框的 Dialog

```kotlin
@Composable
fun InputDialogExample() {
    var showDialog by remember { mutableStateOf(false) }
    var inputText by remember { mutableStateOf("") }
    var dialogResult by remember { mutableStateOf<String?>(null) }

    Column(
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        Button(
            onClick = { showDialog = true },
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("显示输入对话框")
        }

        // 显示结果
        dialogResult?.let { result ->
            Card(
                colors = CardDefaults.cardColors(
                    containerColor = MaterialTheme.colorScheme.secondaryContainer
                )
            ) {
                Text(
                    text = "输入内容: $result",
                    modifier = Modifier.padding(16.dp),
                    color = MaterialTheme.colorScheme.onSecondaryContainer
                )
            }
        }
    }

    // 输入对话框
    if (showDialog) {
        Dialog(
            onDismissRequest = {
                showDialog = false
                dialogResult = null
            },
            properties = DialogProperties(
                dismissOnBackPress = false,
                dismissOnClickOutside = false
            )
        ) {
            Surface(
                modifier = Modifier
                    .fillMaxWidth()
                    .aspectRatio(1.2f),
                shape = MaterialTheme.shapes.large,
                color = MaterialTheme.colorScheme.surface,
                shadowElevation = 8.dp
            ) {
                Column(
                    modifier = Modifier.padding(24.dp),
                    verticalArrangement = Arrangement.SpaceBetween
                ) {
                    Text(
                        text = "输入内容",
                        style = MaterialTheme.typography.titleLarge
                    )

                    Column(
                        verticalArrangement = Arrangement.spacedBy(16.dp)
                    ) {
                        OutlinedTextField(
                            value = inputText,
                            onValueChange = { inputText = it },
                            label = { Text("请输入内容") },
                            modifier = Modifier.fillMaxWidth(),
                            singleLine = true
                        )

                        Text(
                            text = "请输入您想要保存的内容，支持中英文字符。",
                            style = MaterialTheme.typography.bodySmall,
                            color = MaterialTheme.colorScheme.onSurfaceVariant
                        )
                    }

                    Row(
                        modifier = Modifier.fillMaxWidth(),
                        horizontalArrangement = Arrangement.spacedBy(8.dp)
                    ) {
                        OutlinedButton(
                            onClick = {
                                showDialog = false
                                inputText = ""
                                dialogResult = null
                            },
                            modifier = Modifier.weight(1f)
                        ) {
                            Text("取消")
                        }

                        Button(
                            onClick = {
                                if (inputText.isNotBlank()) {
                                    showDialog = false
                                    dialogResult = inputText
                                }
                            },
                            enabled = inputText.isNotBlank(),
                            modifier = Modifier.weight(1f)
                        ) {
                            Text("确定")
                        }
                    }
                }
            }
        }
    }
}
```

### 2.3 全屏 Dialog

```kotlin
@Composable
fun FullScreenDialogExample() {
    var showDialog by remember { mutableStateOf(false) }
    var dialogResult by remember { mutableStateOf<String?>(null) }

    Column(
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        Button(
            onClick = { showDialog = true },
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("显示全屏对话框")
        }

        // 显示结果
        dialogResult?.let { result ->
            Card(
                colors = CardDefaults.cardColors(
                    containerColor = MaterialTheme.colorScheme.tertiaryContainer
                )
            ) {
                Text(
                    text = "全屏Dialog结果: $result",
                    modifier = Modifier.padding(16.dp),
                    color = MaterialTheme.colorScheme.onTertiaryContainer
                )
            }
        }
    }

    // 全屏 Dialog
    if (showDialog) {
        Dialog(
            onDismissRequest = {
                showDialog = false
                dialogResult = "全屏Dialog已关闭"
            },
            properties = DialogProperties(
                usePlatformDefaultWidth = false
            )
        ) {
            Surface(
                modifier = Modifier.fillMaxSize(),
                color = MaterialTheme.colorScheme.surface
            ) {
                Column(
                    modifier = Modifier.fillMaxSize()
                ) {
                    // 顶部栏
                    Row(
                        modifier = Modifier
                            .fillMaxWidth()
                            .padding(16.dp),
                        horizontalArrangement = Arrangement.SpaceBetween,
                        verticalAlignment = Alignment.CenterVertically
                    ) {
                        Text(
                            text = "全屏对话框",
                            style = MaterialTheme.typography.titleLarge
                        )
                        IconButton(onClick = {
                            showDialog = false
                            dialogResult = "用户关闭了全屏Dialog"
                        }) {
                            Icon(
                                imageVector = Icons.Default.Close,
                                contentDescription = "关闭"
                            )
                        }
                    }

                    // 内容区域
                    LazyVerticalGrid(
                        columns = GridCells.Adaptive(minSize = 150.dp),
                        contentPadding = PaddingValues(16.dp),
                        horizontalArrangement = Arrangement.spacedBy(16.dp),
                        verticalArrangement = Arrangement.spacedBy(16.dp),
                        modifier = Modifier.weight(1f)
                    ) {
                        items(20) { index ->
                            Card(
                                modifier = Modifier
                                    .fillMaxWidth()
                                    .aspectRatio(1f)
                                    .clickable {
                                        showDialog = false
                                        dialogResult = "用户选择了项目 ${index + 1}"
                                    },
                                elevation = CardDefaults.cardElevation(defaultElevation = 4.dp)
                            ) {
                                Column(
                                    modifier = Modifier
                                        .fillMaxSize()
                                        .padding(16.dp),
                                    horizontalAlignment = Alignment.CenterHorizontally,
                                    verticalArrangement = Arrangement.Center
                                ) {
                                    Surface(
                                        modifier = Modifier.size(48.dp),
                                        shape = CircleShape,
                                        color = MaterialTheme.colorScheme.primaryContainer
                                    ) {
                                        Box(contentAlignment = Alignment.Center) {
                                            Text(
                                                text = "${index + 1}",
                                                style = MaterialTheme.typography.titleMedium,
                                                color = MaterialTheme.colorScheme.onPrimaryContainer
                                            )
                                        }
                                    }
                                    Spacer(modifier = Modifier.height(8.dp))
                                    Text(
                                        text = "项目 ${index + 1}",
                                        style = MaterialTheme.typography.titleSmall
                                    )
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
```

---

## 3. ModalBottomSheet - 模态底部表单

ModalBottomSheet 是从屏幕底部滑出的模态面板，常用于选择器、菜单和详情展示。

### 3.1 基础 ModalBottomSheet

```kotlin
@Composable
fun BasicModalBottomSheetExample() {
    var showBottomSheet by remember { mutableStateOf(false) }
    var selectedOption by remember { mutableStateOf<String?>(null) }

    Column(
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        // 当前选择显示
        Card(
            modifier = Modifier
                .fillMaxWidth()
                .clickable { showBottomSheet = true }
        ) {
            Column(
                modifier = Modifier.padding(20.dp),
                horizontalAlignment = Alignment.CenterHorizontally
            ) {
                Text(
                    text = "当前选择",
                    style = MaterialTheme.typography.bodyMedium,
                    color = MaterialTheme.colorScheme.onSurfaceVariant
                )
                Spacer(modifier = Modifier.height(8.dp))
                Text(
                    text = selectedOption ?: "点击选择",
                    style = MaterialTheme.typography.titleMedium
                )
            }
        }

        // 触发按钮
        Button(
            onClick = { showBottomSheet = true },
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("显示选择器")
        }
    }

    // ModalBottomSheet
    if (showBottomSheet) {
        ModalBottomSheet(
            onDismissRequest = {
                showBottomSheet = false
            },
            sheetState = rememberModalBottomSheetState()
        ) {
            Column(
                modifier = Modifier.padding(24.dp),
                verticalArrangement = Arrangement.spacedBy(16.dp)
            ) {
                Text(
                    text = "选择选项",
                    style = MaterialTheme.typography.titleLarge,
                    modifier = Modifier.align(Alignment.CenterHorizontally)
                )

                HorizontalDivider(
                    modifier = Modifier.padding(vertical = 8.dp),
                    color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.12f)
                )

                val options = listOf("选项 1", "选项 2", "选项 3", "选项 4", "选项 5")

                options.forEach { option ->
                    Row(
                        modifier = Modifier
                            .fillMaxWidth()
                            .clickable {
                                selectedOption = option
                                showBottomSheet = false
                            }
                            .padding(vertical = 16.dp),
                        verticalAlignment = Alignment.CenterVertically
                    ) {
                        Icon(
                            imageVector = Icons.Default.RadioButtonUnchecked,
                            contentDescription = null,
                            modifier = Modifier.size(24.dp),
                            tint = MaterialTheme.colorScheme.onSurfaceVariant
                        )
                        Spacer(modifier = Modifier.width(16.dp))
                        Text(
                            text = option,
                            style = MaterialTheme.typography.bodyLarge,
                            modifier = Modifier.weight(1f)
                        )
                    }
                }

                Button(
                    onClick = {
                        showBottomSheet = false
                    },
                    modifier = Modifier.fillMaxWidth()
                ) {
                    Text("取消")
                }
            }
        }
    }
}
```

### 3.2 图标网格 ModalBottomSheet

```kotlin
@Composable
fun GridModalBottomSheetExample() {
    var showBottomSheet by remember { mutableStateOf(false) }
    var selectedAction by remember { mutableStateOf<String?>(null) }

    Column(
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        // 显示结果
        selectedAction?.let { action ->
            Card(
                colors = CardDefaults.cardColors(
                    containerColor = MaterialTheme.colorScheme.primaryContainer
                )
            ) {
                Text(
                    text = "选择的操作: $action",
                    modifier = Modifier.padding(16.dp),
                    color = MaterialTheme.colorScheme.onPrimaryContainer
                )
            }
        }

        Button(
            onClick = { showBottomSheet = true },
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("显示操作菜单")
        }
    }

    // 图标网格 ModalBottomSheet
    if (showBottomSheet) {
        ModalBottomSheet(
            onDismissRequest = {
                showBottomSheet = false
            },
            sheetState = rememberModalBottomSheetState(),
            dragHandle = {
                Surface(
                    modifier = Modifier
                        .padding(vertical = 4.dp)
                        .width(32.dp)
                        .height(4.dp),
                    shape = CircleShape,
                    color = MaterialTheme.colorScheme.onSurfaceVariant
                ) {}
            }
        ) {
            Column(
                modifier = Modifier.padding(24.dp),
                verticalArrangement = Arrangement.spacedBy(16.dp)
            ) {
                Text(
                    text = "选择操作",
                    style = MaterialTheme.typography.titleLarge,
                    modifier = Modifier.align(Alignment.CenterHorizontally)
                )

                val actions = listOf(
                    Triple("分享", Icons.Default.Share, MaterialTheme.colorScheme.primary),
                    Triple("编辑", Icons.Default.Edit, MaterialTheme.colorScheme.secondary),
                    Triple("删除", Icons.Default.Delete, MaterialTheme.colorScheme.error),
                    Triple("收藏", Icons.Default.Favorite, MaterialTheme.colorScheme.tertiary),
                    Triple("下载", Icons.Default.Download, MaterialTheme.colorScheme.primary),
                    Triple("复制", Icons.Default.ContentCopy, MaterialTheme.colorScheme.secondary)
                )

                actions.chunked(3).forEach { chunk ->
                    Row(
                        modifier = Modifier.fillMaxWidth(),
                        horizontalArrangement = Arrangement.SpaceEvenly
                    ) {
                        chunk.forEach { (text, icon, color) ->
                            Column(
                                horizontalAlignment = Alignment.CenterHorizontally,
                                modifier = Modifier
                                    .padding(8.dp)
                                    .clickable {
                                        selectedAction = text
                                        showBottomSheet = false
                                    }
                            ) {
                                Surface(
                                    modifier = Modifier.size(48.dp),
                                    shape = CircleShape,
                                    color = color.copy(alpha = 0.1f)
                                ) {
                                    Box(contentAlignment = Alignment.Center) {
                                        Icon(
                                            imageVector = icon,
                                            contentDescription = text,
                                            tint = color,
                                            modifier = Modifier.size(24.dp)
                                        )
                                    }
                                }
                                Spacer(modifier = Modifier.height(8.dp))
                                Text(
                                    text = text,
                                    style = MaterialTheme.typography.bodySmall
                                )
                            }
                        }
                    }
                }
            }
        }
    }
}
```

### 3.3 颜色选择器 ModalBottomSheet

```kotlin
@Composable
fun ColorPickerModalBottomSheetExample() {
    var showBottomSheet by remember { mutableStateOf(false) }
    var selectedColor by remember { mutableStateOf<androidx.compose.ui.graphics.Color?>(null) }

    Column(
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        // 当前颜色显示
        Card(
            modifier = Modifier
                .fillMaxWidth()
                .clickable { showBottomSheet = true }
        ) {
            Row(
                modifier = Modifier.padding(20.dp),
                verticalAlignment = Alignment.CenterVertically
            ) {
                Text(
                    text = "当前颜色",
                    style = MaterialTheme.typography.titleMedium,
                    modifier = Modifier.weight(1f)
                )
                Surface(
                    modifier = Modifier.size(40.dp),
                    shape = CircleShape,
                    color = selectedColor ?: MaterialTheme.colorScheme.primary
                ) {}
            }
        }

        Button(
            onClick = { showBottomSheet = true },
            modifier = Modifier.fillMaxWidth()
        ) {
            Text("选择颜色")
        }
    }

    // 颜色选择器 ModalBottomSheet
    if (showBottomSheet) {
        ModalBottomSheet(
            onDismissRequest = {
                showBottomSheet = false
            },
            sheetState = rememberModalBottomSheetState()
        ) {
            Column(
                modifier = Modifier.padding(24.dp)
            ) {
                Text(
                    text = "选择颜色",
                    style = MaterialTheme.typography.titleLarge,
                    modifier = Modifier.align(Alignment.CenterHorizontally)
                )

                Spacer(modifier = Modifier.height(24.dp))

                val colors = listOf(
                    "红色" to androidx.compose.ui.graphics.Color.Red,
                    "绿色" to androidx.compose.ui.graphics.Color.Green,
                    "蓝色" to androidx.compose.ui.graphics.Color.Blue,
                    "黄色" to androidx.compose.ui.graphics.Color.Yellow,
                    "紫色" to androidx.compose.ui.graphics.Color.Magenta,
                    "青色" to androidx.compose.ui.graphics.Color.Cyan,
                    "橙色" to androidx.compose.ui.graphics.Color(0xFFFF9800),
                    "粉色" to androidx.compose.ui.graphics.Color(0xFFE91E63),
                    "灰色" to androidx.compose.ui.graphics.Color.Gray
                )

                LazyVerticalGrid(
                    columns = GridCells.Fixed(3),
                    horizontalArrangement = Arrangement.spacedBy(16.dp),
                    verticalArrangement = Arrangement.spacedBy(16.dp)
                ) {
                    items(colors) { (name, color) ->
                        Column(
                            horizontalAlignment = Alignment.CenterHorizontally,
                            modifier = Modifier.clickable {
                                selectedColor = color
                                showBottomSheet = false
                            }
                        ) {
                            Surface(
                                modifier = Modifier.size(48.dp),
                                shape = CircleShape,
                                color = color,
                                border = if (selectedColor == color) {
                                    ButtonDefaults.outlinedButtonBorder
                                } else null
                            ) {}
                            Spacer(modifier = Modifier.height(8.dp))
                            Text(
                                text = name,
                                style = MaterialTheme.typography.bodySmall
                            )
                        }
                    }
                }

                Spacer(modifier = Modifier.height(16.dp))

                Button(
                    onClick = { showBottomSheet = false },
                    modifier = Modifier.fillMaxWidth()
                ) {
                    Text("取消")
                }
            }
        }
    }
}
```

---

## 4. 实践示例：完整的多类型弹窗系统

```kotlin
@Composable
fun CompleteDialogSystemExample() {
    var alertDialogResult by remember { mutableStateOf<String?>(null) }
    var dialogResult by remember { mutableStateOf<String?>(null) }
    var bottomSheetResult by remember { mutableStateOf<String?>(null) }

    var showAlertDialog by remember { mutableStateOf(false) }
    var showInputDialog by remember { mutableStateOf(false) }
    var showGridDialog by remember { mutableStateOf(false) }
    var showActionSheet by remember { mutableStateOf(false) }

    Column(
        modifier = Modifier
            .fillMaxSize()
            .padding(16.dp),
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        Text(
            text = "完整弹窗系统",
            style = MaterialTheme.typography.headlineMedium,
            fontWeight = FontWeight.Bold
        )

        // 不同类型的弹窗按钮
        Column(
            verticalArrangement = Arrangement.spacedBy(12.dp)
        ) {
            // AlertDialog 类型
            Card {
                Column(modifier = Modifier.padding(16.dp)) {
                    Text(
                        text = "AlertDialog",
                        style = MaterialTheme.typography.titleMedium,
                        fontWeight = FontWeight.Bold
                    )
                    Spacer(modifier = Modifier.height(8.dp))
                    Row(
                        modifier = Modifier.fillMaxWidth(),
                        horizontalArrangement = Arrangement.spacedBy(8.dp)
                    ) {
                        Button(
                            onClick = { showAlertDialog = true },
                            modifier = Modifier.weight(1f)
                        ) {
                            Text("确认", style = MaterialTheme.typography.labelSmall)
                        }
                        Button(
                            onClick = { showGridDialog = true },
                            modifier = Modifier.weight(1f)
                        ) {
                            Text("选择", style = MaterialTheme.typography.labelSmall)
                        }
                    }
                }
            }

            // Dialog 类型
            Card {
                Column(modifier = Modifier.padding(16.dp)) {
                    Text(
                        text = "Dialog",
                        style = MaterialTheme.typography.titleMedium,
                        fontWeight = FontWeight.Bold
                    )
                    Spacer(modifier = Modifier.height(8.dp))
                    Button(
                        onClick = { showInputDialog = true },
                        modifier = Modifier.fillMaxWidth()
                    ) {
                        Text("输入对话框", style = MaterialTheme.typography.labelSmall)
                    }
                }
            }

            // ModalBottomSheet 类型
            Card {
                Column(modifier = Modifier.padding(16.dp)) {
                    Text(
                        text = "ModalBottomSheet",
                        style = MaterialTheme.typography.titleMedium,
                        fontWeight = FontWeight.Bold
                    )
                    Spacer(modifier = Modifier.height(8.dp))
                    Button(
                        onClick = { showActionSheet = true },
                        modifier = Modifier.fillMaxWidth()
                    ) {
                        Text("操作菜单", style = MaterialTheme.typography.labelSmall)
                    }
                }
            }
        }

        // 结果显示区域
        if (alertDialogResult != null || dialogResult != null || bottomSheetResult != null) {
            Card {
                Column(modifier = Modifier.padding(16.dp)) {
                    Text(
                        text = "操作结果",
                        style = MaterialTheme.typography.titleMedium,
                        fontWeight = FontWeight.Bold
                    )
                    alertDialogResult?.let {
                        Text("AlertDialog: $it", style = MaterialTheme.typography.bodySmall)
                    }
                    dialogResult?.let {
                        Text("Dialog: $it", style = MaterialTheme.typography.bodySmall)
                    }
                    bottomSheetResult?.let {
                        Text("BottomSheet: $it", style = MaterialTheme.typography.bodySmall)
                    }
                }
            }
        }
    }

    // 确认 AlertDialog
    if (showAlertDialog) {
        AlertDialog(
            onDismissRequest = {
                showAlertDialog = false
                alertDialogResult = "用户关闭了确认对话框"
            },
            icon = {
                Icon(
                    imageVector = Icons.Default.Info,
                    contentDescription = "信息",
                    tint = MaterialTheme.colorScheme.primary
                )
            },
            title = { Text("确认操作") },
            text = { Text("您确认要执行此操作吗？这将影响系统设置。") },
            confirmButton = {
                Button(
                    onClick = {
                        showAlertDialog = false
                        alertDialogResult = "用户确认了操作"
                    }
                ) {
                    Text("确认")
                }
            },
            dismissButton = {
                TextButton(
                    onClick = {
                        showAlertDialog = false
                        alertDialogResult = "用户取消了操作"
                    }
                ) {
                    Text("取消")
                }
            }
        )
    }

    // 选择 Dialog
    if (showGridDialog) {
        var selectedOption by remember { mutableStateOf("") }

        Dialog(
            onDismissRequest = {
                showGridDialog = false
                alertDialogResult = "用户关闭了选择对话框"
            }
        ) {
            Card(
                modifier = Modifier
                    .fillMaxWidth()
                    .padding(16.dp),
                elevation = CardDefaults.cardElevation(defaultElevation = 8.dp)
            ) {
                Column(
                    modifier = Modifier.padding(24.dp)
                ) {
                    Text(
                        text = "选择选项",
                        style = MaterialTheme.typography.titleLarge,
                        modifier = Modifier.align(Alignment.CenterHorizontally)
                    )

                    Spacer(modifier = Modifier.height(16.dp))

                    val options = listOf("选项 A", "选项 B", "选项 C")
                    LazyVerticalGrid(
                        columns = GridCells.Fixed(2),
                        horizontalArrangement = Arrangement.spacedBy(12.dp),
                        verticalArrangement = Arrangement.spacedBy(12.dp)
                    ) {
                        items(options) { option ->
                            Card(
                                modifier = Modifier
                                    .fillMaxWidth()
                                    .aspectRatio(2f)
                                    .clickable {
                                        selectedOption = option
                                    },
                                colors = CardDefaults.cardColors(
                                    containerColor = if (selectedOption == option)
                                        MaterialTheme.colorScheme.primaryContainer
                                    else MaterialTheme.colorScheme.surface
                                )
                            ) {
                                Box(
                                    modifier = Modifier.fillMaxSize(),
                                    contentAlignment = Alignment.Center
                                ) {
                                    Text(
                                        text = option,
                                        style = MaterialTheme.typography.titleSmall,
                                        color = if (selectedOption == option)
                                            MaterialTheme.colorScheme.onPrimaryContainer
                                        else MaterialTheme.colorScheme.onSurface
                                    )
                                }
                            }
                        }
                    }

                    Spacer(modifier = Modifier.height(16.dp))

                    Row(
                        modifier = Modifier.fillMaxWidth(),
                        horizontalArrangement = Arrangement.spacedBy(8.dp)
                    ) {
                        OutlinedButton(
                            onClick = {
                                showGridDialog = false
                                alertDialogResult = "用户取消了选择"
                            },
                            modifier = Modifier.weight(1f)
                        ) {
                            Text("取消")
                        }
                        Button(
                            onClick = {
                                showGridDialog = false
                                alertDialogResult = "用户选择了: $selectedOption"
                            },
                            enabled = selectedOption.isNotEmpty(),
                            modifier = Modifier.weight(1f)
                        ) {
                            Text("确定")
                        }
                    }
                }
            }
        }
    }

    // 输入 Dialog
    if (showInputDialog) {
        var inputText by remember { mutableStateOf("") }

        Dialog(
            onDismissRequest = {
                showInputDialog = false
                dialogResult = "用户关闭了输入对话框"
            }
        ) {
            Surface(
                modifier = Modifier
                    .fillMaxWidth()
                    .wrapContentHeight(),
                shape = MaterialTheme.shapes.large,
                color = MaterialTheme.colorScheme.surface,
                shadowElevation = 8.dp
            ) {
                Column(
                    modifier = Modifier.padding(24.dp),
                    verticalArrangement = Arrangement.spacedBy(16.dp)
                ) {
                    Text(
                        text = "输入信息",
                        style = MaterialTheme.typography.titleLarge
                    )

                    OutlinedTextField(
                        value = inputText,
                        onValueChange = { inputText = it },
                        label = { Text("请输入内容") },
                        modifier = Modifier.fillMaxWidth()
                    )

                    Row(
                        modifier = Modifier.fillMaxWidth(),
                        horizontalArrangement = Arrangement.spacedBy(8.dp)
                    ) {
                        OutlinedButton(
                            onClick = {
                                showInputDialog = false
                                dialogResult = "用户取消了输入"
                            },
                            modifier = Modifier.weight(1f)
                        ) {
                            Text("取消")
                        }
                        Button(
                            onClick = {
                                showInputDialog = false
                                dialogResult = "用户输入了: $inputText"
                            },
                            enabled = inputText.isNotBlank(),
                            modifier = Modifier.weight(1f)
                        ) {
                            Text("确定")
                        }
                    }
                }
            }
        }
    }

    // 操作菜单 ModalBottomSheet
    if (showActionSheet) {
        ModalBottomSheet(
            onDismissRequest = {
                showActionSheet = false
                bottomSheetResult = "用户关闭了操作菜单"
            }
        ) {
            Column(
                modifier = Modifier.padding(24.dp),
                verticalArrangement = Arrangement.spacedBy(16.dp)
            ) {
                Text(
                    text = "选择操作",
                    style = MaterialTheme.typography.titleLarge,
                    modifier = Modifier.align(Alignment.CenterHorizontally)
                )

                val actions = listOf(
                    "分享" to Icons.Default.Share,
                    "编辑" to Icons.Default.Edit,
                    "删除" to Icons.Default.Delete,
                    "复制" to Icons.Default.ContentCopy,
                    "移动" to Icons.Default.Folder,
                    "收藏" to Icons.Default.Favorite
                )

                actions.forEach { (text, icon) ->
                    Row(
                        modifier = Modifier
                            .fillMaxWidth()
                            .clickable {
                                bottomSheetResult = "用户选择了: $text"
                                showActionSheet = false
                            }
                            .padding(vertical = 12.dp),
                        verticalAlignment = Alignment.CenterVertically
                    ) {
                        Icon(
                            imageVector = icon,
                            contentDescription = text,
                            modifier = Modifier.size(24.dp),
                            tint = MaterialTheme.colorScheme.onSurfaceVariant
                        )
                        Spacer(modifier = Modifier.width(16.dp))
                        Text(
                            text = text,
                            style = MaterialTheme.typography.bodyLarge,
                            modifier = Modifier.weight(1f)
                        )
                    }
                }
            }
        }
    }
}
```

---

## 5. 最佳实践

### 5.1 使用场景选择

1. **AlertDialog**：用于确认操作、显示重要信息
2. **Dialog**：需要自定义布局时的通用对话框
3. **ModalBottomSheet**：选择器、菜单、从底部展示的操作列表

### 5.2 用户体验优化

1. **提供清晰的标题和描述**：帮助用户理解对话框的目的
2. **合理的按钮排列**：主要操作放在右侧，次要操作放在左侧
3. **支持多种关闭方式**：包括按钮、外部点击、返回键等
4. **加载状态处理**：在异步操作时显示进度指示器

### 5.3 无障碍性考虑

1. **设置合适的语义**：为屏幕阅读器提供适当的内容描述
2. **焦点管理**：确保对话框打开时焦点正确设置
3. **键盘导航**：支持键盘操作和导航

### 5.4 性能优化

1. **避免过度重组**：合理使用 remember 和 derivedStateOf
2. **状态管理**：将对话框状态提升到合适的层级
3. **动画优化**：使用适当的进入和退出动画

---

## 6. 总结

Jetpack Compose 的对话框和弹窗组件提供了完整的模态交互解决方案：

1. **AlertDialog**：标准化的确认和信息对话框
2. **Dialog**：高度可定制的通用对话框容器
3. **ModalBottomSheet**：从底部滑出的模态面板
4. **丰富的自定义选项**：支持完全自定义内容和布局
5. **良好的用户体验**：遵循 Material Design 3 设计规范
6. **灵活的交互模式**：支持多种关闭方式和状态管理

通过合理使用这些组件，你可以构建用户友好且符合设计规范的交互界面。

在下一篇文章中，我们将探讨导航组件，学习如何实现页面间的导航和跳转。

---

## 相关资源

- [Material 3 Dialogs Documentation](https://m3.material.io/components/dialogs)
- [Compose Dialog Documentation](https://developer.android.com/jetpack/compose/components/dialog)
- [Compose Bottom Sheets Documentation](https://developer.android.com/jetpack/compose/components/bottomsheet)

---

*本文基于 Android Jetpack Compose 最新版本编写，部分 API 可能会随着版本更新而变化。*